using HeyRed.Mime;
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Web;

namespace MagicCMS.MBFileMan
{
    public static class FileManIcons
    {
        public static readonly string[] HanledImage = (".apng|.gif|.jpg|.jpeg|.jfif|.pjpeg|.pjp|.webp").Split('|');
        public static readonly string[] CodeExtensions = (".c|.cs|.class|.cpp|.h|.java|.php|.vb|.js|.html|.asp|.aspx|.htm").Split('|');

        public static string IconFolder { 
            get
            {
                return @"<svg id='Livello_1' data-name='Livello 1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'
                            viewBox='0 0 180 180'>
                            <defs>
                                <style>
                                    .cls-1 {{
                                        fill: #ffb900;
                                    }}

                                    .cls-2,
                                    .cls-5 {{
                                        fill: #fff;
                                    }}

                                    .cls-3 {{
                                        fill: #ffd75e;
                                    }}

                                    .cls-4 {{
                                        fill: url(#Sfumatura_senza_nome);
                                    }}

                                    .cls-5 {{
                                        isolation: isolate;
                                        opacity: 0.4;
                                    }}

                                    .cls-6 {{
                                        fill: #da7b16;
                                    }}

                                    .hidden {{
                                        opacity:0;
                                    }}

                                    .visible {{
                                        opacity: 1;
                                    }}
                                    .text {{
                                        font-size: 13px;
                                        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
                                        font-weight: 300;
                                        fill: sienna;
                                    }}
                                </style>
                                <linearGradient id='Sfumatura_senza_nome' x1='90' y1='143.8' x2='90' y2='66.4'
                                    gradientTransform='matrix(1, 0, 0, -1, 0, 182)' gradientUnits='userSpaceOnUse'>
                                    <stop offset='0' stop-color='#fff' stop-opacity='0' />
                                    <stop offset='1' stop-color='#ffd75e' stop-opacity='0.3' />
                                </linearGradient>
                            </defs>
                            <path class='cls-1'
                                d='M85.79,38.2l-6-6.08a8.37,8.37,0,0,0-6-2.52H35.21A4.26,4.26,0,0,0,31,33.9v80.27a1.42,1.42,0,0,0,1.4,1.43H147.6a1.42,1.42,0,0,0,1.4-1.43V42.5a4.26,4.26,0,0,0-4.21-4.3Z' />
                            <rect class='cls-2 {0}' x='34.78' y='39.33' width='99.56' height='69.78' />
                            <path class='cls-3'
                                d='M85.79,38.2l-6,6.08a8.37,8.37,0,0,1-6,2.52H31v67.37a1.42,1.42,0,0,0,1.4,1.43H147.6a1.42,1.42,0,0,0,1.4-1.43V42.5a4.26,4.26,0,0,0-4.21-4.3Z' />
                            <path class='cls-4'
                                d='M85.79,38.2l-6,6.08a8.37,8.37,0,0,1-6,2.52H31v67.37a1.42,1.42,0,0,0,1.4,1.43H147.6a1.42,1.42,0,0,0,1.4-1.43V42.5a4.26,4.26,0,0,0-4.21-4.3Z' />
                            <path class='cls-5' d='M31,46.8v1.43H74a9.7,9.7,0,0,0,7-2.94l7-7.09h-2.1l-6,6.08a8.37,8.37,0,0,1-6,2.52Z' />
                            <path class='cls-6' d='M147.6,115.6H32.4a1.42,1.42,0,0,1-1.4-1.43H149A1.42,1.42,0,0,1,147.6,115.6Z' />
                            <text class='text' x='34' y='111.6'>
                                {1}
                            </text>
                        </svg>";
            }
        }

        public static string IconAudio
        {
            get
            {
                return @"<svg id='Livello_1' data-name='Livello 1' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 180 180'>
                            <defs>
                                <style>
                                    .cls-1,
                                    .cls-5 {{
                                        fill: #fff;
                                    }}

                                    .cls-2 {{
                                        fill: none;
                                        stroke: #69afe5;
                                        stroke-linecap: round;
                                        stroke-linejoin: round;
                                        stroke-width: 2.2px;
                                    }}

                                    .cls-3 {{
                                        fill: #979593;
                                    }}

                                    .cls-4 {{
                                        fill: #69afe5;
                                    }}

                                    .cls-5 {{
                                        isolation: isolate;
                                        font-size: 24.57px;
                                        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
                                        font-weight: 800;
                                        text-anchor: middle;
                                    }}
                                </style>
                            </defs>
                            <path class='cls-1'
                                d='M103.3,31.6H59.6a1.32,1.32,0,0,0-1.3,1.3h0v79.3a1.32,1.32,0,0,0,1.3,1.3h61.1a1.32,1.32,0,0,0,1.3-1.3h0V50.3a3.1,3.1,0,0,0-.9-2.2L105.4,32.4A3.87,3.87,0,0,0,103.3,31.6Z' />
                            <path class='cls-2' d='M82.5,69.5V48.3l20.9-5.1V64.5M82.9,55.1,103.4,50' />
                            <circle class='cls-2' cx='77.6' cy='69.1' r='4.9' />
                            <circle class='cls-2' cx='98.4' cy='64.7' r='4.9' />
                            <path class='cls-3'
                                d='M121.9,48.8,103.7,30.6a3.1,3.1,0,0,0-2.2-.9H60.3a3.12,3.12,0,0,0-3.1,3.1v79.9a3.12,3.12,0,0,0,3.1,3.1h59.4a3.12,3.12,0,0,0,3.1-3.1V50.9A3.12,3.12,0,0,0,121.9,48.8ZM102.3,32.1l18,18h-17a.94.94,0,0,1-1-1Zm17.4,81.5H60.3a.94.94,0,0,1-1-1V32.7a.94.94,0,0,1,1-1h39.9V49.1a3.12,3.12,0,0,0,3.1,3.1h17.4v60.4a1,1,0,0,1-1,1Z' />
                            <rect class='cls-4' x='52.3' y='77.5' width='76.1' height='24.3' />
                            <text class='cls-5' transform='translate(90.5 98.14)'>{0}</text>
                            <path class='cls-1' d='M102.3,32.1l18,18h-17a.94.94,0,0,1-1-1Z' />
                        </svg>";
            }
        }

        public static string IconFont
        {
            get
            {
                return @"<svg id='Livello_1' data-name='Livello 1' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 180 180'>
                            <defs>
                                <style>
                                    .cls-1,
                                    .cls-4 {{
                                        fill: #fff;
                                    }}

                                    .cls-2 {{
                                        fill: #979593;
                                    }}

                                    .cls-3 {{
                                        fill: darkcyan;
                                    }}

                                    .cls-4 {{
                                         isolation: isolate;
                                        font-size: 24.57px;
                                        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
                                        font-weight: 800;
                                        text-anchor: middle;
                                    }}

                                    .cls-5 {{
                                        fill: #8c8c8c;
                                    }}

                                    .cls-6 {{
                                        fill: darkcyan;
                                    }}
                                </style>
                            </defs>
                            <path class='cls-1'
                                d='M103.27,31.65H59.56a1.3,1.3,0,0,0-1.3,1.3v79.3a1.3,1.3,0,0,0,1.3,1.3h61.11a1.3,1.3,0,0,0,1.3-1.3V50.35a3,3,0,0,0-.89-2.15L105.41,32.54A3,3,0,0,0,103.27,31.65Z' />
                            <path class='cls-2'
                                d='M121.86,48.75,103.61,30.5a3,3,0,0,0-2.17-.9H60.31a3.08,3.08,0,0,0-3.07,3.07v79.86a3.08,3.08,0,0,0,3.07,3.07h59.38a3.08,3.08,0,0,0,3.07-3.07V50.92A3,3,0,0,0,121.86,48.75ZM102.29,32.07l18,18h-17a1,1,0,0,1-1-1Zm17.4,81.48H60.31a1,1,0,0,1-1-1V32.67a1,1,0,0,1,1-1h39.93v17.4a3.07,3.07,0,0,0,3.07,3.07h17.4v60.41A1,1,0,0,1,119.69,113.55Z' />
                            <path class='cls-3' d='M124.81,101.34H55.42V77.64h69.39Z' /><text class='cls-4'
                                transform='translate(90.49 98.14)'>{0}</text>
                            <path class='cls-5'
                                d='M90.74,61,87.5,66.83l-1.45-4.56H77.88l-1.62,5.11H70.65l8.36-23h6.14ZM84.86,58.3l-2.47-7.72A10,10,0,0,1,82,48.51h-.13a8.76,8.76,0,0,1-.4,2L79,58.3Z' />
                            <path class='cls-6'
                                d='M109.33,74.22c-.16.53-.44.73-.82.6a31.09,31.09,0,0,0-7.85-.12c-.68,0-1-.08-1-.4s.22-.65.74-.87q2.22-.9,2.22-1.74a3.65,3.65,0,0,0-.12-.76q-.53-1.91-1.6-5.7c-.93,0-2.56.08-4.89.08-1.94,0-3.56-.06-4.84-.16-.33.66-1.17,2.27-2.5,4.8a3.31,3.31,0,0,0-.42,1.46,1.5,1.5,0,0,0,1,1.44c1.09.52,1.64.88,1.64,1.07s0,.1,0,.15c-.07.46-.48.64-1.24.55a21.69,21.69,0,0,0-6.63.24,1.37,1.37,0,0,1-.52.06c-.16-.06-.25-.28-.26-.66s.46-.71,1.41-1.13a6.21,6.21,0,0,0,2.69-2.86q4.65-8.34,5.89-10.67,3.23-6,5.09-10.41A3,3,0,0,1,99,47.55c.25-.07.49.32.72,1.16q3,11,6.4,22.26a3.63,3.63,0,0,0,2.51,2.5Q109.47,73.74,109.33,74.22Zm-8.91-10.55L97.6,54.08c-.07-.23-.17-.34-.3-.34s-.28.11-.4.34c-1.21,2.35-2.83,5.51-4.89,9.5,1.32.11,2.86.16,4.6.16C97.74,63.74,99,63.72,100.42,63.67Z' />
                        </svg>";
            }
        }

        public static string IconImage
        {
            get
            {
                return @"<svg id='Livello_1' data-name='Livello 1' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 180 180'>
                            <defs>
                                <style>
                                    .cls-1,
                                    .cls-4 {{
                                        fill: #fff;
                                    }}

                                    .cls-2 {{
                                        fill: #979593;
                                    }}

                                    .cls-3 {{
                                        fill: #ff9810;
                                    }}

                                    .cls-4 {{
                                        isolation: isolate;
                                        font-size: 24.57px;
                                        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
                                        font-weight: 800;
                                        text-anchor: middle;
                                    }}

                                    .cls-5,
                                    .cls-6 {{
                                        fill: none;
                                        stroke-miterlimit: 10;
                                        stroke-width: 1.6px;
                                    }}

                                    .cls-5 {{
                                        stroke: #a6ccc3;
                                    }}

                                    .cls-6 {{
                                        stroke: #ff9810;
                                    }}
                                </style>
                            </defs>
                            <path class='cls-1'
                                d='M103.27,31.65H59.56a1.3,1.3,0,0,0-1.3,1.3h0v79.3a1.3,1.3,0,0,0,1.3,1.3h61.11a1.3,1.3,0,0,0,1.3-1.3h0V50.35a3,3,0,0,0-.89-2.15L105.41,32.54A3,3,0,0,0,103.27,31.65Z' />
                            <path class='cls-2'
                                d='M121.86,48.75,103.61,30.5a3,3,0,0,0-2.17-.9H60.31a3.09,3.09,0,0,0-3.07,3.07v79.86a3.09,3.09,0,0,0,3.07,3.07h59.38a3.09,3.09,0,0,0,3.07-3.07V50.92A3,3,0,0,0,121.86,48.75ZM102.29,32.07l18,18h-17a1,1,0,0,1-1-1Zm17.4,81.48H60.31a1,1,0,0,1-1-1V32.67a1,1,0,0,1,1-1h39.93v17.4a3.06,3.06,0,0,0,3.07,3.07h17.4v60.41a1,1,0,0,1-1,1Z' />
                            <rect class='cls-3' x='52.33' y='77.5' width='76.1' height='24.3' />
                            <text class='cls-4' transform='translate(90.5 98.14)'>{0}</text>
                            <path class='cls-5'
                                d='M81.83,56.19a1.61,1.61,0,0,0-2.24.34L70.34,69.07A1.58,1.58,0,0,0,70,70a1.61,1.61,0,0,0,1.6,1.61h36.75A1.61,1.61,0,0,0,109.64,69L97.26,53.23A1.44,1.44,0,0,0,97,53a1.61,1.61,0,0,0-2.25.27l-7.08,9a.75.75,0,0,1-.15.16.81.81,0,0,1-1.12-.16l-4.22-5.72A1.52,1.52,0,0,0,81.83,56.19Z' />
                            <circle class='cls-6' cx='74.82' cy='48.81' r='4.8' />
                        </svg>";
            }
        }

        public static string IconText
        {
            get
            {
                return @"   <svg id='Livello_1' data-name='Livello 1' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 180 180'>
                                <defs>
                                    <style>
                                        .cls-1,
                                        .cls-4 {{
                                            fill: #fff;
                                        }}

                                        .cls-2 {{
                                            fill: #979593;
                                        }}

                                        .cls-3 {{
                                            fill: darkgoldenrod;
                                        }}

                                        .cls-4 {{
                                            font-size: 24.57px;
                                            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
                                            font-weight: 800;
                                            text-anchor: middle;
                                        }}
                                        .cls-5 {{
                                            fill: #bfbdba;
                                        }}
                                    </style>
                                </defs>
                                <path class='cls-1'
                                    d='M103.27,31.65H59.56a1.3,1.3,0,0,0-1.3,1.3v79.3a1.3,1.3,0,0,0,1.3,1.3h61.11a1.3,1.3,0,0,0,1.3-1.3V50.35a3,3,0,0,0-.89-2.15L105.41,32.54A3,3,0,0,0,103.27,31.65Z' />
                                <path class='cls-2'
                                    d='M121.86,48.75,103.61,30.5a3,3,0,0,0-2.17-.9H60.31a3.08,3.08,0,0,0-3.07,3.07v79.86a3.08,3.08,0,0,0,3.07,3.07h59.38a3.08,3.08,0,0,0,3.07-3.07V50.92A3,3,0,0,0,121.86,48.75ZM102.29,32.07l18,18h-17a1,1,0,0,1-1-1Zm17.4,81.48H60.31a1,1,0,0,1-1-1V32.67a1,1,0,0,1,1-1h39.93v17.4a3.07,3.07,0,0,0,3.07,3.07h17.4v60.41A1,1,0,0,1,119.69,113.55Z' />
                                <path class='cls-5'
                                    d='M113.55,61.34H66.45a1,1,0,0,1-1-1h0a1,1,0,0,1,1-1h47.1a1,1,0,0,1,1,1h0A1,1,0,0,1,113.55,61.34Zm0,6.14H66.45a1,1,0,0,1-1-1h0a1,1,0,0,1,1-1h47.1a1,1,0,0,1,1,1h0A1,1,0,0,1,113.55,67.48Zm0,6.14H66.45a1,1,0,0,1-1-1h0a1,1,0,0,1,1-1h47.1a1,1,0,0,1,1,1h0A1,1,0,0,1,113.55,73.62Zm0,6.15H66.45a1,1,0,0,1-1-1h0a1,1,0,0,1,1-1h47.1a1,1,0,0,1,1,1h0A1,1,0,0,1,113.55,79.77Z' />
                                <rect  class='cls-3' x='52.33' y='77.5' width='76.1' height='24.3' />
                                <text class='cls-4' transform='translate(90.5 98.14)'>{0}</text>
                            </svg>";
            }
        }

        public static string IconVideo
        {
            get
            {
                return @"   <svg id='Livello_1' data-name='Livello 1' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 180 180'>
                                <defs>
                                    <style>
                                        .cls-1,
                                        .cls-5 {{
                                            fill: #fff;
                                        }}

                                        .cls-2 {{
                                            fill: none;
                                            stroke: #69afe5;
                                            stroke-linecap: round;
                                            stroke-linejoin: round;
                                            stroke-width: 2.2px;
                                        }}

                                        .cls-3 {{
                                            fill: #979593;
                                        }}

                                        .cls-4 {{
                                            fill: lightgreen;
                                        }}

                                        .cls-5 {{
                                            isolation: isolate;
                                            font-size: 24.57px;
                                            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
                                            font-weight: 800;
                                            text-anchor: middle;
                                        }}
                                    </style>
                                </defs>
                                <path class='cls-1'
                                    d='M103.3,31.6H59.6a1.32,1.32,0,0,0-1.3,1.3h0v79.3a1.32,1.32,0,0,0,1.3,1.3h61.1a1.32,1.32,0,0,0,1.3-1.3h0V50.3a3.1,3.1,0,0,0-.9-2.2L105.4,32.4A3.87,3.87,0,0,0,103.3,31.6Z' />
                                <path fill='#4CAF50'
                                    d='M74.11,47.48h22a4,4,0,0,1,4,4v16a4,4,0,0,1-4,4h-22a4,4,0,0,1-4-4v-16A4,4,0,0,1,74.11,47.48Z' />
                                <polygon fill='#388E3C' points='110.11 70.48 100.11 64.48 100.11 54.48 110.11 48.48 110.11 70.48' />

                                <path class='cls-3'
                                    d='M121.9,48.8,103.7,30.6a3.1,3.1,0,0,0-2.2-.9H60.3a3.12,3.12,0,0,0-3.1,3.1v79.9a3.12,3.12,0,0,0,3.1,3.1h59.4a3.12,3.12,0,0,0,3.1-3.1V50.9A3.12,3.12,0,0,0,121.9,48.8ZM102.3,32.1l18,18h-17a.94.94,0,0,1-1-1Zm17.4,81.5H60.3a.94.94,0,0,1-1-1V32.7a.94.94,0,0,1,1-1h39.9V49.1a3.12,3.12,0,0,0,3.1,3.1h17.4v60.4a1,1,0,0,1-1,1Z' />
                                <rect class='cls-4' x='52.3' y='77.5' width='76.1' height='24.3' />
                                <text class='cls-5' transform='translate(90.5 98.14)'>{0}</text>
                                <path class='cls-1' d='M102.3,32.1l18,18h-17a.94.94,0,0,1-1-1Z' />
                            </svg>";
            }
        }

        public static string IconPdf
        {
            get
            {
                return @"   <svg id='Livello_1' data-name='Livello 1' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 180 180'>
                                <defs>
                                    <style>
                                        .cls-1,
                                        .cls-4 {{
                                            fill: #fff;
                                        }}

                                        .cls-2 {{
                                            fill: #979593;
                                        }}

                                        .cls-3 {{
                                            fill: red;
                                        }}

                                        .cls-4 {{
                                            font-size: 24.57px;
                                            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
                                            font-weight: 800;
                                            text-anchor: middle;
                                        }}

                                        .cls-5 {{
                                            fill: darkgray;
                                        }}
                                    </style>
                                </defs>
                                <path class='cls-1'
                                    d='M103.27,31.65H59.56a1.3,1.3,0,0,0-1.3,1.3v79.3a1.3,1.3,0,0,0,1.3,1.3h61.11a1.3,1.3,0,0,0,1.3-1.3V50.35a3,3,0,0,0-.89-2.15L105.41,32.54A3,3,0,0,0,103.27,31.65Z' />
                                <path class='cls-2'
                                    d='M121.86,48.75,103.61,30.5a3,3,0,0,0-2.17-.9H60.31a3.08,3.08,0,0,0-3.07,3.07v79.86a3.08,3.08,0,0,0,3.07,3.07h59.38a3.08,3.08,0,0,0,3.07-3.07V50.92A3,3,0,0,0,121.86,48.75ZM102.29,32.07l18,18h-17a1,1,0,0,1-1-1Zm17.4,81.48H60.31a1,1,0,0,1-1-1V32.67a1,1,0,0,1,1-1h39.93v17.4a3.07,3.07,0,0,0,3.07,3.07h17.4v60.41A1,1,0,0,1,119.69,113.55Z' />
                                <g id='Layer_2' data-name='Layer 2'>
                                    <g id='Layer_86' data-name='Layer 86'>
                                        <path id='_64' data-name=' 64' class='cls-5'
                                            d='M108.73,66.63c-2.92-3-10.91-1.8-12.82-1.57A34.15,34.15,0,0,1,90.51,58a32.29,32.29,0,0,0,1.8-9.33c0-2.81-1.12-5.85-4.27-5.85a3.26,3.26,0,0,0-2.7,1.58c-1.35,2.36-.79,7.08,1.35,11.92A81.6,81.6,0,0,1,81.18,69.1C77.92,70.45,71.06,73.6,70.5,77a3,3,0,0,0,.9,2.81,4.33,4.33,0,0,0,2.81,1c4.16,0,8.21-5.74,11-10.57A74.9,74.9,0,0,1,95,67.64C99.4,71.47,103.22,72,105.24,72c2.7,0,3.71-1.13,4.05-2.14A2.92,2.92,0,0,0,108.73,66.63Zm-2.81,1.91c-.11.79-1.13,1.58-2.93,1.13a15.6,15.6,0,0,1-5.73-2.93,24.35,24.35,0,0,1,7.08-.11C105.24,66.86,106.14,67.42,105.92,68.54ZM87.14,45.38a1.13,1.13,0,0,1,.9-.56c1,0,1.24,1.23,1.24,2.25a25.24,25.24,0,0,1-1.35,7C86.24,49.54,86.58,46.39,87.14,45.38Zm-.23,21.81A62.8,62.8,0,0,0,89.5,60.9a28.84,28.84,0,0,0,3.6,4.61C93.1,65.62,89.61,66.29,86.91,67.19Zm-6.63,4.5c-2.59,4.27-5.28,7-6.75,7a1.6,1.6,0,0,1-.67-.22.85.85,0,0,1-.34-1C72.86,75.85,75.78,73.71,80.28,71.69Z' />
                                    </g>
                                </g>    
                                <path class='cls-3' d='M124.7,101.34H55.3V77.64h69.4Z' />
                                <text class='cls-4'
                                    transform='translate(90.48 98.14)'>{0}</text>

                            </svg>";
            }
        }

        public static string IconWord
        {
            get
            {
                return @"   <svg id='Livello_1' data-name='Livello 1' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 180 180'>
                                <defs>
                                    <style>
                                        .cls-1,
                                        .cls-5 {{
                                            fill: #fff;
                                        }}

                                        .cls-1,
                                        .cls-2 {{
                                            stroke: #979593;
                                            stroke-miterlimit: 10;
                                            stroke-width: 2.1px;
                                        }}

                                        .cls-2 {{
                                            fill: none;
                                        }}

                                        .cls-3 {{
                                            fill: #c8c6c4;
                                        }}

                                        .cls-4 {{
                                            fill: #185abd;
                                        }}
                                        .text {{
                                            font-size: 10px;
                                            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
                                            font-weight: 400;
                                            fill: darkslategray;
                                            text-anchor: end;
                                        }}
                                    </style>
                                </defs>
                                <path class='cls-1'
                                    d='M110.63,29.6H68.5a2.1,2.1,0,0,0-2.1,2.1v81.8a2.1,2.1,0,0,0,2.1,2.1h60.83a2.1,2.1,0,0,0,2.1-2.1V50.4a2.1,2.1,0,0,0-.62-1.49l-18.7-18.7A2.09,2.09,0,0,0,110.63,29.6Z' />
                                <path class='cls-2' d='M110.45,29.6V48.48a2.1,2.1,0,0,0,2.1,2.1h18.88' />
                                <path class='cls-3'
                                    d='M123,86.23H90.52V84.14H123a1,1,0,0,1,1,1h0A1,1,0,0,1,123,86.23Zm0-6.29H90.52v-2.1H123a1,1,0,0,1,1,1h0A1,1,0,0,1,123,79.94Zm0-6.29H90.52v-2.1H123a1,1,0,0,1,1,1h0A1,1,0,0,1,123,73.65Zm0-6.29H90.52v-2.1H123a1,1,0,0,1,1,1h0A1,1,0,0,1,123,67.36Zm0,25.17H90.52v-2.1H123a1,1,0,0,1,1,1h0A1,1,0,0,1,123,92.53Z' />
                                <path class='cls-4'
                                    d='M52.77,99.87H86.33a4.19,4.19,0,0,0,4.19-4.2V62.11a4.19,4.19,0,0,0-4.19-4.19H52.77a4.2,4.2,0,0,0-4.2,4.19V95.67A4.2,4.2,0,0,0,52.77,99.87Z' />
                                <path class='cls-5'
                                    d='M62.86,85.86c.07.55.12,1,.14,1.43h.08c0-.38.09-.85.18-1.4s.18-1,.27-1.38l3.7-16.11H72l3.83,15.87a23.77,23.77,0,0,1,.48,3h.06a25,25,0,0,1,.4-2.89l3.07-16h4.36L78.86,91.48H73.77L70.11,76.19c-.11-.44-.23-1-.36-1.72s-.22-1.22-.25-1.54h-.06c0,.37-.13.93-.25,1.67s-.22,1.29-.3,1.64L65.46,91.48H60.28L54.87,68.4h4.44l3.34,16.14Q62.76,85,62.86,85.86Z' />
                                <text class='text' x='129' y='111.6'>{0}</text>
                            </svg>";
            }
        }

        public static string IconExcel
        {
            get
            {
                return @"<  svg id='Livello_1' data-name='Livello 1' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 180 180'>
                                <defs>
                                    <style>
                                        .cls-1,
                                        .cls-5 {{
                                            fill: #fff;
                                        }}

                                        .cls-1,
                                        .cls-2 {{
                                            stroke: #979593;
                                            stroke-miterlimit: 10;
                                            stroke-width: 2.1px;
                                        }}

                                        .cls-2 {{
                                            fill: none;
                                        }}

                                        .cls-3 {{
                                            fill: #c8c6c4;
                                        }}

                                        .cls-4 {{
                                            fill: #107c41;
                                        }}
                                        .text {{
                                            font-size: 10px;
                                            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
                                            font-weight: 400;
                                            fill: darkslategray;
                                            text-anchor: end;
                                        }}

                                    </style>
                                </defs>
                                <path class='cls-1'
                                    d='M110.63,29.6H68.5a2.1,2.1,0,0,0-2.1,2.1v81.8a2.1,2.1,0,0,0,2.1,2.1h60.83a2.1,2.1,0,0,0,2.1-2.1V50.4a2.1,2.1,0,0,0-.62-1.49l-18.7-18.7A2.09,2.09,0,0,0,110.63,29.6Z' />
                                <path class='cls-2' d='M110.45,29.6V48.48a2.1,2.1,0,0,0,2.1,2.1h18.88' />
                                <path class='cls-3'
                                    d='M93.67,86.23H83.18V84.14H93.67a1,1,0,0,1,1,1h0A1,1,0,0,1,93.67,86.23Zm0-6.29H83.18v-2.1H93.67a1,1,0,0,1,1,1h0A1,1,0,0,1,93.67,79.94Zm0-6.29H83.18v-2.1H93.67a1,1,0,0,1,1,1h0A1,1,0,0,1,93.67,73.65Zm0-6.29H83.18v-2.1H93.67a1,1,0,0,1,1,1h0A1,1,0,0,1,93.67,67.36Zm0,25.17H83.18v-2.1H93.67a1,1,0,0,1,1,1h0A1,1,0,0,1,93.67,92.53ZM123,86.23H112.55a1,1,0,0,1-1-1h0a1,1,0,0,1,1-1H123a1,1,0,0,1,1,1h0A1,1,0,0,1,123,86.23Zm0,6.3H112.55a1,1,0,0,1-1-1h0a1,1,0,0,1,1-1H123a1,1,0,0,1,1,1h0A1,1,0,0,1,123,92.53Zm0-12.59H112.55a1,1,0,0,1-1-1h0a1,1,0,0,1,1-1H123a1,1,0,0,1,1,1h0A1,1,0,0,1,123,79.94Zm0-6.29H112.55a1,1,0,0,1-1-1.05h0a1,1,0,0,1,1-1H123a1,1,0,0,1,1,1h0A1,1,0,0,1,123,73.65Zm0-6.29H112.55a1,1,0,0,1-1-1h0a1,1,0,0,1,1-1H123a1,1,0,0,1,1,1h0A1,1,0,0,1,123,67.36ZM108.35,86.23H97.87a1,1,0,0,1-1.05-1h0a1,1,0,0,1,1.05-1h10.48a1,1,0,0,1,1.05,1h0A1,1,0,0,1,108.35,86.23Zm0,6.3H97.87a1,1,0,0,1-1.05-1h0a1,1,0,0,1,1.05-1h10.48a1,1,0,0,1,1.05,1h0A1,1,0,0,1,108.35,92.53Zm0-12.59H97.87a1,1,0,0,1-1.05-1h0a1,1,0,0,1,1.05-1h10.48a1,1,0,0,1,1.05,1h0A1,1,0,0,1,108.35,79.94Zm0-6.29H97.87a1,1,0,0,1-1.05-1.05h0a1,1,0,0,1,1.05-1h10.48a1,1,0,0,1,1.05,1h0A1,1,0,0,1,108.35,73.65Zm0-6.29H97.87a1,1,0,0,1-1.05-1h0a1,1,0,0,1,1.05-1h10.48a1,1,0,0,1,1.05,1h0A1,1,0,0,1,108.35,67.36Z' />
                                <path class='cls-4'
                                    d='M52.77,99.87H86.33a4.19,4.19,0,0,0,4.19-4.2V62.11a4.19,4.19,0,0,0-4.19-4.19H52.77a4.2,4.2,0,0,0-4.2,4.19V95.67A4.2,4.2,0,0,0,52.77,99.87Z' />
                                <path class='cls-5'
                                    d='M58,91.48l8.27-12.62L58.65,66.31h6.1l4.13,8c.38.76.65,1.33.79,1.7h0c.28-.61.56-1.2.86-1.77l4.42-8h5.59L72.82,78.79l8,12.69h-6l-4.78-8.81a7.66,7.66,0,0,1-.57-1.18h-.07a5.6,5.6,0,0,1-.55,1.14L64,91.48Z' />
                                <text class='text' x='129' y='111.6'>{0}</text>
                            </svg>";
            }
        }

        public static string IconPresentation
        {
            get
            {
                return @"   <svg id='Livello_1' data-name='Livello 1' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 180 180'>
                                <defs>
                                    <style>
                                        .cls-1 {{
                                            fill: #fff;
                                        }}

                                        .cls-1,
                                        .cls-2 {{
                                            stroke: #979593;
                                            stroke-miterlimit: 10;
                                            stroke-width: 2.98px;
                                        }}

                                        .cls-2 {{
                                            fill: none;
                                        }}

                                        .cls-3 {{
                                            fill: #c8c6c4;
                                        }}

                                        .cls-4 {{
                                            fill: #b7472a;
                                        }}
                                        .text {{
                                            font-size: 10px;
                                            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
                                            font-weight: 400;
                                            fill: darkslategray;
                                            text-anchor: end;
                                        }}
                                    </style>
                                </defs>
                                <path class='cls-1'
                                    d='M118.53,30.93H34.94a3,3,0,0,0-3,3v77.38a3,3,0,0,0,3,3H145.06a3,3,0,0,0,3-3V60.44a3,3,0,0,0-.87-2.1L120.63,31.8A3,3,0,0,0,118.53,30.93Z' />
                                <path class='cls-2' d='M118.27,30.93V57.72a3,3,0,0,0,3,3H148' />
                                <path class='cls-3'
                                    d='M69.17,66.65H43.87a1.49,1.49,0,0,1-1.49-1.49h0a1.49,1.49,0,0,1,1.49-1.49h25.3a1.49,1.49,0,0,1,1.48,1.49h0A1.49,1.49,0,0,1,69.17,66.65Zm0-8.93H43.87a1.49,1.49,0,0,1-1.49-1.49h0a1.49,1.49,0,0,1,1.49-1.49h25.3a1.49,1.49,0,0,1,1.48,1.49h0A1.49,1.49,0,0,1,69.17,57.72Zm0,17.86H43.87a1.49,1.49,0,0,1-1.49-1.49h0a1.49,1.49,0,0,1,1.49-1.49h25.3a1.49,1.49,0,0,1,1.48,1.49h0A1.49,1.49,0,0,1,69.17,75.58Zm0,8.93H43.87A1.49,1.49,0,0,1,42.38,83h0a1.49,1.49,0,0,1,1.49-1.49h25.3A1.49,1.49,0,0,1,70.65,83h0A1.49,1.49,0,0,1,69.17,84.51Zm0,8.92H43.87A1.49,1.49,0,0,1,42.38,92h0a1.49,1.49,0,0,1,1.49-1.49h25.3A1.48,1.48,0,0,1,70.65,92h0A1.48,1.48,0,0,1,69.17,93.43Zm0,8.93H43.87a1.49,1.49,0,0,1-1.49-1.49h0a1.49,1.49,0,0,1,1.49-1.48h25.3a1.48,1.48,0,0,1,1.48,1.48h0A1.48,1.48,0,0,1,69.17,102.36Z' />
                                <path class='cls-4' d='M100.42,57.72a17.85,17.85,0,0,1,17.85,17.86H100.42Z' />
                                <path class='cls-3' d='M118.27,78.55A20.83,20.83,0,1,1,97.44,57.72V78.55Z' />
                                <text class='text' x='144.5' y='109.6'>{0}</text>
                            </svg>";
            }
        }

        public static string IconCode
        {
            get
            {
                return @"   <svg id='Livello_1' data-name='Livello 1' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 180 180'>
                                <defs>
                                    <style>
                                        .cls-1,
                                        .cls-4 {{
                                            fill: #fff;
                                        }}

                                        .cls-2 {{
                                            fill: #979593;
                                        }}

                                        .cls-3 {{
                                            fill: #69afe5;
                                        }}

                                        .cls-4 {{
                                            font-size: 24.57px;
                                            font-family: Arial-Black, Arial;
                                            font-weight: 800;
                                            text-anchor: middle;
                                        }}

                                        .cls-5 {{
                                            fill: #5b5b5b;
                                        }}
                                    </style>
                                </defs>
                                <path class='cls-1'
                                    d='M103.41,31.34H59.7a1.3,1.3,0,0,0-1.3,1.3V112a1.3,1.3,0,0,0,1.3,1.3h61.1a1.3,1.3,0,0,0,1.3-1.3V50a3.06,3.06,0,0,0-.88-2.14L105.55,32.23A3,3,0,0,0,103.41,31.34Z' />
                                <path class='cls-2'
                                    d='M121.86,48.75,103.61,30.5a3,3,0,0,0-2.17-.9H60.31a3.08,3.08,0,0,0-3.07,3.07v79.86a3.08,3.08,0,0,0,3.07,3.07h59.38a3.08,3.08,0,0,0,3.07-3.07V50.92A3,3,0,0,0,121.86,48.75ZM102.29,32.07l18,18h-17a1,1,0,0,1-1-1Zm17.4,81.48H60.31a1,1,0,0,1-1-1V32.67a1,1,0,0,1,1-1h39.93v17.4a3.07,3.07,0,0,0,3.07,3.07h17.4v60.41A1,1,0,0,1,119.69,113.55Z' />
                                <path class='cls-3' d='M124.7,101.85H55.3V78.15h69.4Z' />
                                <text class='cls-4'  transform='translate(90.48 98.64)'>{0}</text>
                                <path class='cls-5'
                                    d='M74.44,63.71c0,.21,0,.38,0,.53s0,.27,0,.39h-6a2.65,2.65,0,0,0,.73,2,2.92,2.92,0,0,0,2.1.69c.25,0,.49,0,.74,0s.49,0,.72-.08l.67-.11c.21,0,.4-.09.58-.14v1.21a12.73,12.73,0,0,1-1.35.28,11.51,11.51,0,0,1-1.57.1,5.5,5.5,0,0,1-1.88-.29,3.33,3.33,0,0,1-1.3-.86A3.66,3.66,0,0,1,67.14,66a6.63,6.63,0,0,1-.24-1.85,5.26,5.26,0,0,1,.26-1.7,4.34,4.34,0,0,1,.75-1.41,3.53,3.53,0,0,1,2.85-1.31,4,4,0,0,1,1.57.28,3.07,3.07,0,0,1,1.16.79,3.36,3.36,0,0,1,.71,1.24A5.28,5.28,0,0,1,74.44,63.71Zm-1.53-.21a3.17,3.17,0,0,0-.11-1,2.23,2.23,0,0,0-.42-.81,2,2,0,0,0-.71-.53,2.48,2.48,0,0,0-1-.19,2.14,2.14,0,0,0-.88.19,2.17,2.17,0,0,0-.69.52,2.82,2.82,0,0,0-.46.82,3.69,3.69,0,0,0-.22,1Z' />
                                <path class='cls-5' d='M83.48,65.89H76.2l.25-1.25h7.28Zm.6-3H76.79L77,61.7h7.29Z' />
                                <path class='cls-5'
                                    d='M92.39,68.41v-6.1a5.86,5.86,0,0,0,0-.66,1.59,1.59,0,0,0-.09-.4.53.53,0,0,0-.16-.21.48.48,0,0,0-.24-.06.54.54,0,0,0-.32.11,1.25,1.25,0,0,0-.31.33,4.71,4.71,0,0,0-.36.6c-.13.25-.29.56-.47.93v5.46H89.06V62.47a7.56,7.56,0,0,0,0-.76,2,2,0,0,0-.09-.45.44.44,0,0,0-.17-.22.45.45,0,0,0-.24-.06.52.52,0,0,0-.29.09,1.4,1.4,0,0,0-.3.3,6.08,6.08,0,0,0-.37.6c-.13.26-.29.58-.48,1v5.46H85.74v-8.5h1.12l.07,1.62a7.81,7.81,0,0,1,.43-.83,3.17,3.17,0,0,1,.42-.54,1.66,1.66,0,0,1,.47-.31,1.69,1.69,0,0,1,.56-.09,1.24,1.24,0,0,1,1,.45,2.17,2.17,0,0,1,.36,1.38q.2-.44.39-.78a2.63,2.63,0,0,1,.42-.57,1.55,1.55,0,0,1,.5-.36,1.52,1.52,0,0,1,.62-.12c1.07,0,1.6.82,1.6,2.46v6.19Z' />
                                <path class='cls-5'
                                    d='M101.79,68.06a9.47,9.47,0,0,1-1.32.36,7.45,7.45,0,0,1-1.25.11,3.86,3.86,0,0,1-2.61-.79,2.9,2.9,0,0,1-.91-2.34,6.16,6.16,0,0,1,.41-2.33,5.32,5.32,0,0,1,1.1-1.76,5,5,0,0,1,1.65-1.13,5.13,5.13,0,0,1,2-.39,8.45,8.45,0,0,1,1.22.09,6,6,0,0,1,1.16.31L103,61.53a4.88,4.88,0,0,0-1.06-.36,5.7,5.7,0,0,0-1.14-.13,3.07,3.07,0,0,0-1.51.36,3.48,3.48,0,0,0-1.11.94,4.46,4.46,0,0,0-.68,1.34,5.32,5.32,0,0,0-.23,1.54,2,2,0,0,0,.56,1.55,2.35,2.35,0,0,0,1.64.51,6.12,6.12,0,0,0,1.17-.12,5.64,5.64,0,0,0,1.17-.34Z' />
                                <path class='cls-5'
                                    d='M106.31,63.07l.26-1.29,2.12-1.41,1-.67a4.45,4.45,0,0,0,.61-.49,1.45,1.45,0,0,0,.32-.43,1.36,1.36,0,0,0,.09-.51.65.65,0,0,0-.23-.51,1.1,1.1,0,0,0-.7-.19,2.34,2.34,0,0,0-.86.16,3.26,3.26,0,0,0-.8.43l-.67-.9a4,4,0,0,1,1.23-.71A4.16,4.16,0,0,1,110,56.3a3.14,3.14,0,0,1,.89.12,2.08,2.08,0,0,1,.7.34,1.56,1.56,0,0,1,.46.56,1.66,1.66,0,0,1,.17.75,2.28,2.28,0,0,1-.17.89,2.81,2.81,0,0,1-.5.75,5.25,5.25,0,0,1-.77.68c-.31.22-.65.45-1,.68l-1.11.69H112l-.26,1.31Z' />
                            </svg>";
            }
        }

        public static string IconOther
        {
            get
            {
                return @"   <svg id='Livello_1' data-name='Livello 1' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 180 180'>
                                <defs>
                                    <style>
                                        .cls-1,
                                        .cls-4 {{
                                            fill: #fff;
                                        }}

                                        .cls-2 {{
                                            fill: #979593;
                                        }}

                                        .cls-3 {{
                                            fill: darkgreen;
                                        }}

                                        .cls-4 {{
                                            font-size: 24.57px;
                                            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
                                            font-weight: 800;
                                            text-anchor: middle;
                                        }}
                                    </style>
                                </defs>
                                <path class='cls-1'
                                    d='M103.27,31.65H59.56a1.3,1.3,0,0,0-1.3,1.3v79.3a1.3,1.3,0,0,0,1.3,1.3h61.11a1.3,1.3,0,0,0,1.3-1.3V50.35a3,3,0,0,0-.89-2.15L105.41,32.54A3,3,0,0,0,103.27,31.65Z' />
                                <path class='cls-2'
                                    d='M121.86,48.75,103.61,30.5a3,3,0,0,0-2.17-.9H60.31a3.08,3.08,0,0,0-3.07,3.07v79.86a3.08,3.08,0,0,0,3.07,3.07h59.38a3.08,3.08,0,0,0,3.07-3.07V50.92A3,3,0,0,0,121.86,48.75ZM102.29,32.07l18,18h-17a1,1,0,0,1-1-1Zm17.4,81.48H60.31a1,1,0,0,1-1-1V32.67a1,1,0,0,1,1-1h39.93v17.4a3.07,3.07,0,0,0,3.07,3.07h17.4v60.41A1,1,0,0,1,119.69,113.55Z' />
                                <rect  class='cls-3' x='52.33' y='77.5' width='76.1' height='24.3' />
                                <text class='cls-4' transform='translate(90.5 98.14)'>{0}</text>
                            </svg>";
            }
        }

        public static IconType GetIconType(FileInfo fi)
        {
            string extension = fi.Extension;
            string mimeType = MimeTypesMap.GetMimeType(fi.Extension);
            string[] mimeTypeParts = mimeType.Split('/');
            string type = mimeTypeParts[0];
            string subtype = mimeTypeParts[1];
            IconType iconType = IconType.Other;
            if (HanledImage.Contains(extension.ToLower()))
                iconType = IconType.ImageHandled;
            else if (subtype.Contains("png"))
                iconType = IconType.Png;
            else if (subtype.Contains("gif"))
                iconType = IconType.Png;
            else if (subtype.Contains("svg"))
                iconType = IconType.Svg;
            else if (type == "image")
                iconType = IconType.ImageNotHandled;
            else if (subtype.Contains("ppt") || subtype.Contains("presentation"))
                iconType = IconType.Presentation;
            else if (subtype.Contains("msword") || subtype.Contains("wordprocessing"))
                iconType = IconType.Word;
            else if (subtype.Contains("pdf"))
                iconType = IconType.Pdf;
            else if (subtype.Contains("excel") || subtype.Contains("spreadsheet"))
                iconType = IconType.Excel;
            else if (CodeExtensions.Contains(extension))
                iconType = IconType.Code;
            else if (type == "font" || subtype.Contains("font"))
                iconType = IconType.Font;
            else if (type == "audio")
                iconType |= IconType.Audio;
            else if (type == "text")
                iconType = IconType.Text;
            else if (type == "video")
                iconType = IconType.Video;
            else if ((fi.Attributes & FileAttributes.Directory) == FileAttributes.Directory)
                iconType = IconType.Folder;
            return iconType;
        }

        public static string GetIcon(FileInfo fi)
        {
            
            long folderChildren = 0;
            bool notFound = !fi.Exists;
            bool dirNotFound = true;
            bool isFolder = (fi.Attributes & FileAttributes.Directory) == FileAttributes.Directory;
            if (isFolder)
            {
                if (Directory.Exists(fi.FullName))
                {
                    folderChildren = Directory.EnumerateFileSystemEntries(fi.FullName).ToArray().LongLength;
                    dirNotFound = false;
                }
                    
                 
            }  

            IconType iconType = GetIconType(fi);

            switch (iconType)
            {
                case IconType.Folder:
                    if(dirNotFound)
                    {
                        return String.Format(IconFolder, "hidden", "non trovato");
                    }
                    else if (folderChildren > 0)
                    {
                        return String.Format(IconFolder, "visible", folderChildren);
                    }
                    return String.Format(IconFolder, "hidden", folderChildren);

                case IconType.Audio:
                    if (notFound)
                        return String.Format(IconAudio, 404);
                    else
                        return String.Format(IconAudio, fi.Extension);

                case IconType.Font:
                    if (notFound)
                        return String.Format(IconFont, 404);
                    else
                        return String.Format(IconFont, fi.Extension);

                case IconType.ImageHandled:
                case IconType.Png:
                case IconType.Gif:
                    if (notFound)
                        return String.Format(IconImage, 404);
                    else 
                        return "";
 
                case IconType.ImageNotHandled:
                    if (notFound)
                        return String.Format(IconImage, 404);
                    else
                        return String.Format(IconImage, fi.Extension);

                case IconType.Svg:

                    if (notFound)
                        return String.Format(IconImage, 404);
                    else
                    {
                        DateTime lastAccess = fi.LastAccessTime;
                        string svg = File.ReadAllText(fi.FullName);
                        File.SetLastAccessTime(fi.FullName, lastAccess);
                        return svg;
                    }   

                case IconType.Text:
                    if (notFound)
                        return String.Format(IconText, 404);
                    else
                        return String.Format(IconText, fi.Extension);
                    
                case IconType.Video:
                    if (notFound)
                        return String.Format(IconVideo, 404);
                    else
                        return String.Format(IconVideo, fi.Extension);

                case IconType.Pdf:
                    if (notFound)
                        return String.Format(IconPdf, 404);
                    else
                        return String.Format(IconPdf, fi.Extension);
                    
                case IconType.Word:
                    if (notFound)
                        return String.Format(IconWord, 404);
                    else
                        return String.Format(IconWord, fi.Extension);
                    
                case IconType.Excel:
                    if (notFound)
                        return String.Format(IconExcel, 404);
                    else
                        return String.Format(IconExcel, fi.Extension);
                    
                case IconType.Presentation:
                    if (notFound)
                        return String.Format(IconPresentation, 404);
                    else
                        return String.Format(IconPresentation, fi.Extension);

                case IconType.Code:
                    if (notFound)
                        return String.Format(IconCode, 404);
                    else
                        return String.Format(IconCode, fi.Extension);
                    
                default:
                    if (notFound)
                        return String.Format(IconOther, 404);
                    else
                        return String.Format(IconOther, fi.Extension);
                    
            }

        }
    }

    public enum IconType
    {
        Folder, Audio, Font, ImageHandled, ImageNotHandled, Png, Gif, Svg, Text, Video, Pdf, Word, Excel, Presentation, Code, Other
    }
}